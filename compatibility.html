<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ” ã‚ãªãŸã¨ã€ãªã‚‹ã¹ãä¼šã„ãŸããªã„äººè¨ºæ–­</title>
    <!-- OGP / Twitter Card -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="ZURE MATCH - ç›¸æ€§è¨ºæ–­">
    <meta property="og:description" content="ã‚«ã‚¹éŠ€æ²³ã‹ã‚‰ç²¾åº¦2%ã®é‹å‹¢æƒ…å ±ã‚’ãŠå±Šã‘">
    <meta property="og:url" content="https://ryo909.github.io/kasu-ura/compatibility.html">
    <meta property="og:image" content="https://ryo909.github.io/kasu-ura/assets/ogp.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ZURE MATCH - ç›¸æ€§è¨ºæ–­">
    <meta name="twitter:description" content="ã‚«ã‚¹éŠ€æ²³ã‹ã‚‰ç²¾åº¦2%ã®é‹å‹¢æƒ…å ±ã‚’ãŠå±Šã‘">
    <meta name="twitter:image" content="https://ryo909.github.io/kasu-ura/assets/ogp.png">
    <link rel="canonical" href="https://ryo909.github.io/kasu-ura/compatibility.html">
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=M+PLUS+Rounded+1c:wght@300;400;700&display=swap"
        rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            background: linear-gradient(135deg, #0a0a23 0%, #1a1a3a 50%, #0d1b2a 100%);
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {

            0%,
            100% {
                opacity: 0.3;
            }

            50% {
                opacity: 1;
            }
        }

        .container {
            position: relative;
            z-index: 10;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 0;
        }

        .back-button {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 255, 255, 0.2);
            border: 1px solid #00ffff;
            color: #00ffff;
            padding: 10px 20px;
            border-radius: 20px;
            text-decoration: none;
            font-family: 'Orbitron', monospace;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .back-button:hover {
            background: rgba(0, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .logo {
            font-family: 'Orbitron', monospace;
            font-size: 2.2em;
            font-weight: 900;
            margin-bottom: 15px;
            text-shadow: 0 0 20px #ff6b6b;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                text-shadow: 0 0 20px #ff6b6b;
            }

            50% {
                text-shadow: 0 0 30px #ff6b6b, 0 0 40px #ff6b6b;
            }
        }

        .subtitle {
            font-size: 1.1em;
            color: #ffa500;
            margin-bottom: 20px;
            font-style: italic;
        }

        .description {
            font-size: 0.95em;
            color: #cccccc;
            line-height: 1.6;
            max-width: 600px;
            margin: 0 auto;
        }

        .input-form {
            background: rgba(255, 107, 107, 0.05);
            border: 2px solid #ff6b6b;
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            position: relative;
            overflow: hidden;
        }

        .input-form::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 107, 107, 0.1), transparent);
            animation: scan 3s infinite;
        }

        @keyframes scan {
            0% {
                left: -100%;
            }

            100% {
                left: 100%;
            }
        }

        .form-title {
            font-family: 'Orbitron', monospace;
            font-size: 1.3em;
            color: #ff6b6b;
            margin-bottom: 25px;
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .input-group {
            margin-bottom: 25px;
            position: relative;
            z-index: 2;
        }

        .input-label {
            display: block;
            font-weight: bold;
            color: #ffa500;
            margin-bottom: 10px;
            font-family: 'Orbitron', monospace;
        }

        .input-select {
            width: 100%;
            padding: 12px 15px;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: #ffffff;
            font-size: 1em;
            font-family: 'M PLUS Rounded 1c', sans-serif;
            transition: all 0.3s ease;
        }

        .input-select:focus {
            outline: none;
            border-color: #ff6b6b;
            box-shadow: 0 0 15px rgba(255, 107, 107, 0.3);
        }

        .input-select option {
            background: #1a1a3a;
            color: #ffffff;
        }

        .diagnose-button {
            width: 100%;
            max-width: 300px;
            margin: 30px auto 0;
            padding: 15px 30px;
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            color: white;
            border: none;
            border-radius: 25px;
            font-family: 'Orbitron', monospace;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            display: block;
        }

        .diagnose-button:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(255, 107, 107, 0.5);
        }

        .diagnose-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .loading {
            display: none;
            text-align: center;
            margin: 30px 0;
            font-family: 'Orbitron', monospace;
            color: #ff6b6b;
        }

        .loading.active {
            display: block;
        }

        .loading-text {
            font-size: 1.1em;
            margin-bottom: 20px;
        }

        .loading-animation {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
        }

        .wave-dot {
            width: 12px;
            height: 12px;
            background: #ff6b6b;
            border-radius: 50%;
            animation: wave 1.5s ease-in-out infinite;
        }

        .wave-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .wave-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        .wave-dot:nth-child(4) {
            animation-delay: 0.6s;
        }

        @keyframes wave {

            0%,
            80%,
            100% {
                transform: scale(0.8);
                opacity: 0.5;
            }

            40% {
                transform: scale(1.2);
                opacity: 1;
            }
        }

        .result-area {
            display: none;
            margin: 30px 0;
        }

        .result-area.active {
            display: block;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }

            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result-section {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid #666;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }

        .result-section.user-info {
            border-color: #00ffff;
            background: rgba(0, 255, 255, 0.05);
        }

        .result-section.worst-match {
            border-color: #ff6b6b;
            background: rgba(255, 107, 107, 0.05);
        }

        .result-section.codename {
            border-color: #ffa500;
            background: rgba(255, 165, 0, 0.05);
        }

        .result-title {
            font-family: 'Orbitron', monospace;
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .result-title.user {
            color: #00ffff;
        }

        .result-title.worst {
            color: #ff6b6b;
        }

        .result-title.code {
            color: #ffa500;
        }

        .type-display {
            font-size: 1.1em;
            font-weight: bold;
            color: #ffffff;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
        }

        .codename-main {
            font-size: 1.8em;
            font-weight: bold;
            color: #ffa500;
            text-align: center;
            margin: 20px 0;
            font-family: 'Orbitron', monospace;
            text-shadow: 0 0 10px rgba(255, 165, 0, 0.5);
        }

        .codename-alias {
            font-size: 1.1em;
            color: #ffdd44;
            text-align: center;
            margin: 15px 0;
            font-style: italic;
        }

        .codename-description {
            font-size: 1em;
            color: #cccccc;
            line-height: 1.6;
            margin: 15px 0;
        }

        .countermeasure {
            background: rgba(0, 255, 0, 0.1);
            border-left: 4px solid #00ff00;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .countermeasure-title {
            color: #00ff00;
            font-weight: bold;
            margin-bottom: 10px;
            font-family: 'Orbitron', monospace;
        }

        .testimony {
            background: rgba(255, 255, 0, 0.1);
            border-left: 4px solid #ffff00;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            font-style: italic;
        }

        .testimony-title {
            color: #ffff00;
            font-weight: bold;
            margin-bottom: 10px;
            font-family: 'Orbitron', monospace;
        }

        .share-section {
            margin-top: 30px;
            text-align: center;
            padding: 25px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .share-title {
            font-family: 'Orbitron', monospace;
            font-size: 1.1em;
            color: #ff6b6b;
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
        }

        .share-button {
            display: inline-block;
            padding: 12px 25px;
            margin: 8px;
            background: linear-gradient(45deg, #ff6b6b, #ffa500, #ff6b6b);
            background-size: 200% 200%;
            color: white;
            border: none;
            border-radius: 25px;
            font-family: 'Orbitron', monospace;
            font-size: 0.9em;
            font-weight: bold;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s ease;
            animation: shareGlow 2s ease-in-out infinite alternate;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
        }

        .share-button:hover {
            transform: scale(1.1) translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.6);
        }

        @keyframes shareGlow {
            0% {
                box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
                background-position: 0% 50%;
            }

            100% {
                box-shadow: 0 4px 25px rgba(255, 107, 107, 0.5);
                background-position: 100% 50%;
            }
        }

        .restart-button {
            background: rgba(0, 255, 255, 0.2);
            border: 1px solid #00ffff;
            color: #00ffff;
            padding: 12px 25px;
            border-radius: 20px;
            font-family: 'Orbitron', monospace;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .restart-button:hover {
            background: rgba(0, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            color: #888;
            font-size: 0.9em;
        }

        @media (max-width: 768px) {
            .logo {
                font-size: 1.8em;
            }

            .container {
                padding: 15px;
            }

            .input-form {
                padding: 20px;
            }

            .back-button {
                position: static;
                margin-bottom: 20px;
                display: inline-block;
            }
        }
    </style>
</head>

<body>
    <div class="stars" id="stars"></div>

    <div class="container">
        <a href="#" class="back-button" onclick="history.back()">â† ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹</a>

        <header class="header">
            <h1 class="logo">ğŸ” ZURE MATCHï¼ˆã‚ºãƒ¬ãƒãƒƒãƒï¼‰</h1>
            <p class="subtitle">ã™ã‚Œé•ã†ã¨ã„ã†ã‚ˆã‚Šã€ãŸã¶ã‚“é•ã†æ¬¡å…ƒã®äººã€‚å®‡å®™ã®ã‚ºãƒ¬ã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
            <p class="description">
                MBTIãƒ»è¡€æ¶²å‹ãƒ»æ˜Ÿåº§ã‹ã‚‰ã€ã‚ãªãŸã«ã¨ã£ã¦"ãªã‚‹ã¹ãè·é›¢ã‚’å–ã‚ŠãŸã„äºº"ã‚’ã‚«ã‚¹ãƒ©ãŒå…¨åŠ›ã§æŠ½å‡ºã—ã¾ã™ã€‚<br>
                ä¿¡é ¼ã§ãã‚‹çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ï¼ˆã¨ã€ã‚«ã‚¹ãƒ©ã®åè¦‹ï¼‰ã«ã‚‚ã¨ã¥ã„ã¦ã€ç›¸æ€§æœ€æ‚ªã®ã‚¿ã‚¤ãƒ—ã¨ã€ã‚‚ã—å‡ºä¼šã£ã¦ã—ã¾ã£ãŸå ´åˆã®å¯¾å‡¦æ³•ã¾ã§ã”æ¡ˆå†…ã—ã¾ã™ã€‚
            </p>
        </header>

        <main>
            <div class="input-form">
                <h2 class="form-title">ğŸ“‹ ã‚ãªãŸã®åŸºæœ¬æƒ…å ±</h2>

                <div class="input-group">
                    <label class="input-label" for="mbtiSelect">MBTIï¼ˆ16ã‚¿ã‚¤ãƒ—ï¼‰</label>
                    <select class="input-select" id="mbtiSelect">
                        <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                        <option value="INTJ">INTJï¼ˆå»ºç¯‰å®¶ï¼‰</option>
                        <option value="INTP">INTPï¼ˆè«–ç†å­¦è€…ï¼‰</option>
                        <option value="ENTJ">ENTJï¼ˆæŒ‡æ®å®˜ï¼‰</option>
                        <option value="ENTP">ENTPï¼ˆè¨è«–è€…ï¼‰</option>
                        <option value="INFJ">INFJï¼ˆæå”±è€…ï¼‰</option>
                        <option value="INFP">INFPï¼ˆä»²ä»‹è€…ï¼‰</option>
                        <option value="ENFJ">ENFJï¼ˆä¸»äººå…¬ï¼‰</option>
                        <option value="ENFP">ENFPï¼ˆåºƒå ±é‹å‹•å®¶ï¼‰</option>
                        <option value="ISTJ">ISTJï¼ˆç®¡ç†è€…ï¼‰</option>
                        <option value="ISFJ">ISFJï¼ˆæ“è­·è€…ï¼‰</option>
                        <option value="ESTJ">ESTJï¼ˆå¹¹éƒ¨ï¼‰</option>
                        <option value="ESFJ">ESFJï¼ˆé ˜äº‹å®˜ï¼‰</option>
                        <option value="ISTP">ISTPï¼ˆå·¨åŒ ï¼‰</option>
                        <option value="ISFP">ISFPï¼ˆå†’é™ºå®¶ï¼‰</option>
                        <option value="ESTP">ESTPï¼ˆèµ·æ¥­å®¶ï¼‰</option>
                        <option value="ESFP">ESFPï¼ˆã‚¨ãƒ³ã‚¿ãƒ¼ãƒ†ã‚¤ãƒŠãƒ¼ï¼‰</option>
                    </select>
                </div>

                <div class="input-group">
                    <label class="input-label" for="bloodSelect">è¡€æ¶²å‹</label>
                    <select class="input-select" id="bloodSelect">
                        <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                        <option value="A">Aå‹</option>
                        <option value="B">Bå‹</option>
                        <option value="O">Oå‹</option>
                        <option value="AB">ABå‹</option>
                    </select>
                </div>

                <div class="input-group">
                    <label class="input-label" for="zodiacSelect">æ˜Ÿåº§</label>
                    <select class="input-select" id="zodiacSelect">
                        <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                        <option value="ç‰¡ç¾Šåº§">ç‰¡ç¾Šåº§ï¼ˆ3/21-4/19ï¼‰</option>
                        <option value="ç‰¡ç‰›åº§">ç‰¡ç‰›åº§ï¼ˆ4/20-5/20ï¼‰</option>
                        <option value="åŒå­åº§">åŒå­åº§ï¼ˆ5/21-6/21ï¼‰</option>
                        <option value="èŸ¹åº§">èŸ¹åº§ï¼ˆ6/22-7/22ï¼‰</option>
                        <option value="ç…å­åº§">ç…å­åº§ï¼ˆ7/23-8/22ï¼‰</option>
                        <option value="ä¹™å¥³åº§">ä¹™å¥³åº§ï¼ˆ8/23-9/22ï¼‰</option>
                        <option value="å¤©ç§¤åº§">å¤©ç§¤åº§ï¼ˆ9/23-10/23ï¼‰</option>
                        <option value="è åº§">è åº§ï¼ˆ10/24-11/22ï¼‰</option>
                        <option value="å°„æ‰‹åº§">å°„æ‰‹åº§ï¼ˆ11/23-12/21ï¼‰</option>
                        <option value="å±±ç¾Šåº§">å±±ç¾Šåº§ï¼ˆ12/22-1/19ï¼‰</option>
                        <option value="æ°´ç“¶åº§">æ°´ç“¶åº§ï¼ˆ1/20-2/18ï¼‰</option>
                        <option value="é­šåº§">é­šåº§ï¼ˆ2/19-3/20ï¼‰</option>
                    </select>
                </div>

                <button class="diagnose-button" id="diagnoseButton" onclick="startDiagnosis()">
                    ğŸ” ç›¸æ€§æœ€æ‚ªã‚’è¨ºæ–­ã™ã‚‹
                </button>
            </div>

            <div class="loading" id="loading">
                <div class="loading-text">ã‚«ã‚¹ãƒ©ãŒå…¨åŠ›ã§ç›¸æ€§æœ€æ‚ªã‚’æŠ½å‡ºä¸­...</div>
                <div class="loading-animation">
                    <div class="wave-dot"></div>
                    <div class="wave-dot"></div>
                    <div class="wave-dot"></div>
                    <div class="wave-dot"></div>
                </div>
                <div style="font-size: 0.9em; color: #888; margin-top: 15px;">
                    çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã¨åè¦‹ã‚’ç…§åˆã—ã¦ã„ã¾ã™...
                </div>
            </div>

            <div class="result-area" id="resultArea">
                <div class="result-section user-info">
                    <div class="result-title user">ğŸ‘¤ ã‚ãªãŸã®æƒ…å ±</div>
                    <div class="type-display" id="userType">
                        <!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¿ã‚¤ãƒ—ãŒè¡¨ç¤ºã•ã‚Œã‚‹ -->
                    </div>
                </div>

                <div class="result-section worst-match">
                    <div class="result-title worst">âš ï¸ ç›¸æ€§æœ€æ‚ªãªç›¸æ‰‹</div>
                    <div style="font-weight: bold; color: #ff6b6b; margin-bottom: 10px;">ã“ã®ã‚¿ã‚¤ãƒ—ã¨ã¯ãŸã¶ã‚“åˆã„ã¾ã›ã‚“ï¼š</div>
                    <div class="type-display" id="worstType">
                        <!-- ç›¸æ€§æœ€æ‚ªã®ã‚¿ã‚¤ãƒ—ãŒè¡¨ç¤ºã•ã‚Œã‚‹ -->
                    </div>
                </div>

                <div class="result-section codename">
                    <div class="result-title code">ğŸ§¾ ã‚³ãƒ¼ãƒ‰ãƒãƒ¼ãƒ </div>
                    <div class="codename-main" id="codeName">
                        <!-- ã‚³ãƒ¼ãƒ‰ãƒãƒ¼ãƒ ãŒè¡¨ç¤ºã•ã‚Œã‚‹ -->
                    </div>
                    <div class="codename-alias" id="codeAlias">
                        <!-- é€šç§°ãŒè¡¨ç¤ºã•ã‚Œã‚‹ -->
                    </div>
                    <div class="codename-description" id="codeDescription">
                        <!-- èª¬æ˜ãŒè¡¨ç¤ºã•ã‚Œã‚‹ -->
                    </div>
                </div>

                <div class="countermeasure">
                    <div class="countermeasure-title">ğŸ’¡ å‡ºä¼šã£ã¦ã—ã¾ã£ãŸå ´åˆã®å¯¾å‡¦æ³•</div>
                    <div id="countermeasureText">
                        <!-- å¯¾å‡¦æ³•ãŒè¡¨ç¤ºã•ã‚Œã‚‹ -->
                    </div>
                </div>

                <div class="testimony">
                    <div class="testimony-title">ğŸ“¢ ã‚«ã‚¹è¢«å®³è«‡</div>
                    <div id="testimonyText">
                        <!-- è¢«å®³è«‡ãŒè¡¨ç¤ºã•ã‚Œã‚‹ -->
                    </div>
                </div>

                <div class="share-section">
                    <div class="share-title">ğŸ“¢ çµæœã‚’è¦‹ã›ã³ã‚‰ã‹ã™</div>
                    <button class="share-button" onclick="shareToTwitter()">
                        ğ• æœ€æ‚ªãªå‡ºä¼šã„ã‚’æ™’ã™
                    </button>
                    <button class="share-button" onclick="shareToLine()">
                        ğŸ’¬ LINEã§å…±æœ‰
                    </button>
                    <button class="share-button" id="copyUrlBtn" onclick="copyResultUrl()">
                        ğŸ“‹ çµæœURLã‚’ã‚³ãƒ”ãƒ¼
                    </button>
                    <div style="margin-top: 20px;">
                        <button class="restart-button" onclick="restartDiagnosis()">
                            ğŸ”„ ã‚‚ã†ä¸€åº¦è¨ºæ–­ã™ã‚‹
                        </button>
                    </div>
                </div>
            </div>
        </main>

        <footer class="footer">
            <p>â€»ã“ã®è¨ºæ–­çµæœã¯ã€ã‚«ã‚¹ãƒ©ã®åè¦‹ã¨é©å½“ãªçµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã„ã¦ã„ã¾ã™ã€‚</p>
            <p>å®Ÿéš›ã®äººé–“é–¢ä¿‚ã«æ‚ªå½±éŸ¿ã‚’ä¸ãˆã¦ã‚‚ã€ä¸€åˆ‡è²¬ä»»ã¯è² ã„ã¾ã›ã‚“ã€‚</p>
        </footer>
    </div>

    <script>
        // ==== Seeded Random (mulberry32) ====
        function mulberry32(seed) {
            return function () {
                var t = seed += 0x6D2B79F5;
                t = Math.imul(t ^ t >>> 15, t | 1);
                t ^= t + Math.imul(t ^ t >>> 7, t | 61);
                return ((t ^ t >>> 14) >>> 0) / 4294967296;
            };
        }
        function hashString(str) {
            var hash = 0;
            for (var i = 0; i < str.length; i++) {
                hash = ((hash << 5) - hash) + str.charCodeAt(i);
                hash = hash & hash;
            }
            return Math.abs(hash);
        }
        // Get URL params
        var urlParams = new URLSearchParams(window.location.search);
        var currentSeed = urlParams.get('seed') || '';
        var seededRandom = null;

        // Copy URL to clipboard
        function copyResultUrl() {
            navigator.clipboard.writeText(window.location.href).then(function () {
                var btn = document.getElementById('copyUrlBtn');
                if (btn) {
                    btn.textContent = 'âœ… ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼';
                    setTimeout(function () { btn.textContent = 'ğŸ“‹ çµæœURLã‚’ã‚³ãƒ”ãƒ¼'; }, 2000);
                }
            });
        }

        var currentResult = null;

        var mbtiMapping = {
            "ISTJ": { worstMatch: "ENFP", conflictType: 19 },
            "ISFJ": { worstMatch: "ENTP", conflictType: 16 },
            "INFJ": { worstMatch: "ESTP", conflictType: 13 },
            "INTJ": { worstMatch: "ESFP", conflictType: 8 },
            "ISTP": { worstMatch: "ESFJ", conflictType: 12 },
            "ISFP": { worstMatch: "ESTJ", conflictType: 2 },
            "INFP": { worstMatch: "ESTJ", conflictType: 1 },
            "INTP": { worstMatch: "ESFJ", conflictType: 11 },
            "ESTP": { worstMatch: "INFJ", conflictType: 13 },
            "ESFP": { worstMatch: "INTJ", conflictType: 7 },
            "ENFP": { worstMatch: "ISTJ", conflictType: 10 },
            "ENTP": { worstMatch: "ISFJ", conflictType: 6 },
            "ESTJ": { worstMatch: "INFP", conflictType: 5 },
            "ESFJ": { worstMatch: "ISTP", conflictType: 4 },
            "ENFJ": { worstMatch: "ISFP", conflictType: 15 },
            "ENTJ": { worstMatch: "ISFP", conflictType: 3 }
        };

        var mbtiPersonality = {
            "ISTJ": "ãã£ã¡ã‚Šã—ã¦ã‚‹ã®ã«ã€ãªãœã‹å‘¨å›²ãŒã–ã‚ã¤ãã€‚",
            "ISFJ": "å…¨æ–¹ä½ã«å„ªã—ã™ãã¦ã€ã„ã¤ã‚‚å¿ƒãŒæ¶ˆè€—æ°—å‘³ã€‚",
            "INFJ": "ãªã‚“ã¨ãªãå…¨éƒ¨ã‚ã‹ã£ã¦ã‚‹ã‘ã©ã€è¨€ã‚ãªã„ã§è¦‹å®ˆã‚‹ã€‚",
            "INTJ": "é ­ã®ä¸­ã§10å¹´å…ˆã®è¨ˆç”»ã‚’ç«‹ã¦ã¦ã‚‹ã€‚è©±ã¯èã„ã¦ã‚‹é¢¨ã€‚",
            "ISTP": "å·¥å…·ã®ä½¿ã„æ–¹ã«å“²å­¦ã‚’æ„Ÿã˜ã¦ã‚‹ã€‚è©±ã¯çŸ­ã„ãŒçš„ç¢ºã€‚",
            "ISFP": "é™ã‹ã«çˆ†ç™ºã—ã¦ã‚‹ã€‚å†…ãªã‚‹ä¸–ç•ŒãŒä¸€ç•ªè³‘ã‚„ã‹ã€‚",
            "INFP": "ç†æƒ³ãŒè©°ã¾ã£ãŸç®±ã‚’æŠ±ãˆã¦ã€ã©ã“ã¸ã§ã‚‚è¡ŒããŸã„ã€‚",
            "INTP": "é€”ä¸­ã§è©±ãŒè„±ç·šã—ã¦ã‚‚ã€ãã‚Œã¯ãã‚Œã§æ„å‘³ãŒã‚ã‚‹ã€‚",
            "ESTP": "ä»Šã“ã®ç¬é–“ã«ç”Ÿãã¦ã‚‹ã€‚æœªæ¥ã®è©±ã¯æ˜æ—¥ã€‚",
            "ESFP": "æ¥½ã—ã•ã®ã‚¢ãƒ³ãƒ†ãƒŠãŒãƒ”ã‚«ãƒ”ã‚«ã—ã¦ã‚‹ã€‚ç›®ç«‹ã¡ãŸã„è¨³ã˜ã‚ƒãªã„ã€‚",
            "ENFP": "æƒ…ç†±ã¨ã‚¢ã‚¤ãƒ‡ã‚¢ã¨è„±ç·šã§æ§‹æˆã•ã‚ŒãŸè‡ªç”±ä½“ã€‚",
            "ENTP": "è­°è«–ãŒè¶£å‘³ã€‚çµè«–ã«ã¯ã‚ã¾ã‚Šèˆˆå‘³ãŒãªã„ã€‚",
            "ESTJ": "ãƒªãƒ¼ãƒ€ãƒ¼ã‚’ã—ã¦ã‚‹ã¨è½ã¡ç€ãã€‚æŒ‡ç¤ºå‡ºã—ã¯ç„¡æ„è­˜ã€‚",
            "ESFJ": "ã¿ã‚“ãªã‚’æ°—ã«ã—ã™ãã¦ç–²ã‚Œã‚‹ã€‚ã§ã‚‚ã‚„ã‚ã‚‰ã‚Œãªã„ã€‚",
            "ENFJ": "ä»–äººã®ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ç®¡ç†ãŒè¶£å‘³ã€‚è‡ªåˆ†ã®åˆ†ã¯å¾Œå›ã—ã€‚",
            "ENTJ": "ç›®æ¨™è¨­å®šãŒå¥½ãã™ãã¦ã€ã‚´ãƒ¼ãƒ«ã‚’ã„ãã¤ã‚‚ä½œã£ã¦ã—ã¾ã†ã€‚"
        };

        var conflictTemplates = {
            1: "ã“ã®ã‚¿ã‚¤ãƒ—ã¯ç›´æ„Ÿã¨æ„Ÿæƒ…ã®å‹•ãã‚’é‡è¦–ã—ã€è«–ç†ã‚ˆã‚Šã‚‚æ°—åˆ†ã‚’å„ªå…ˆã—ãŒã¡ã§ã™ã€‚æ§‹é€ çš„ã«è©±ã™ã»ã©ã€ãªã‚“ã‹ã‚¤ãƒ¤ã§è¿”ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒé«˜ã„ã§ã™ã€‚",
            2: "è¡å‹•å‹ã§ã€æ€ã„ç«‹ã£ãŸã‚‰ã™ãè¡Œå‹•ã¨ã„ã†æ€§è³ªãŒå¼·ãã€ãƒªã‚¹ã‚¯ã‚„è¨ˆç”»ã‚ˆã‚Šã‚‚ã‚¹ãƒ”ãƒ¼ãƒ‰å„ªå…ˆã€‚æ…é‡æ´¾ã®ã‚ãªãŸã«ã¯å¤©æ•µã§ã™ã€‚",
            3: "ãƒ«ãƒ¼ãƒ«ã‚„æ çµ„ã¿ã‚’å¤§äº‹ã«ã™ã‚‹å‚¾å‘ãŒã‚ã‚Šã€æŸ”è»Ÿæ€§ã‚„å³èˆˆæ€§ã«ä¸å®‰ã‚’æ„Ÿã˜ã‚‹ã‚¿ã‚¤ãƒ—ã§ã™ã€‚ã‚ãªãŸã®è‡ªç”±ã•ã¯ç§©åºã®å´©å£Šã«è¦‹ãˆã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚",
            4: "å¤–å‘æ€§ãŒé«˜ãã€å¸¸ã«äººã¨ã®æ¥ç‚¹ã‚’æ±‚ã‚ã‚‹ã‚¿ã‚¤ãƒ—ã§ã€é™ã‘ã•ã‚’å¥½ã‚€ã‚ãªãŸã«ã¯åˆºæ¿€éå¤šã€‚ä¸€ç·’ã«ã„ã‚‹ã ã‘ã§é›»æ± ãŒåˆ‡ã‚Œã¾ã™ã€‚",
            5: "æ„Ÿæƒ…ã‚„æ°—æŒã¡ã‚ˆã‚Šã‚‚ã€åŠ¹ç‡ã‚„é€²è¡Œç®¡ç†ã‚’é‡è¦–ã™ã‚‹ã‚¿ã‚¤ãƒ—ã§ã™ã€‚ã‚ã‹ã£ã¦ã»ã—ã„ã¨æ€ã†ç¬é–“ã€ã“ã®äººã¯ToDoãƒªã‚¹ãƒˆã‚’æ›´æ–°ã—ã¦ã„ã¾ã™ã€‚",
            6: "è«–ç†çš„æ•´åˆæ€§ã‚’æœ€é‡è¦–ã—ã€å ´ã®ç©ºæ°—ã‚„æ„Ÿæƒ…ã‚’äºŒã®æ¬¡ã«ã™ã‚‹å‚¾å‘ãŒã‚ã‚Šã¾ã™ã€‚ã¾ã‚ã¾ã‚ã§æµã—ãŸã„è©±é¡Œã§ã‚‚å¿…ãšè½ã¨ã—æ‰€ã‚’æ¤œè¨¼ã—ã¾ã™ã€‚",
            7: "è½ã¡ç€ãã¨é™ã‘ã•ã‚’æ±‚ã‚ã‚‹ã‚ãªãŸã«ã¨ã£ã¦ã€ãƒ†ãƒ³ã‚·ãƒ§ãƒ³é«˜ã‚ã§è©±ã—ç¶šã‘ã‚‹ã“ã®ã‚¿ã‚¤ãƒ—ã¯å¼·æ•µã€‚äº”æ„ŸãŒã™ã¹ã¦è³‘ã‚„ã‹ã«è¥²ã‚ã‚Œã¾ã™ã€‚",
            8: "ç¾å®Ÿã«åŸºã¥ã„ãŸè¨ˆç”»ã‚’é‡è¦–ã™ã‚‹ã“ã®ã‚¿ã‚¤ãƒ—ã¯ã€å¤¢ã‚„å¸Œæœ›ã®è©±ã«ãƒªã‚¢ãƒªãƒ†ã‚£ã‚’æ±‚ã‚ãŒã¡ã§ã™ã€‚ãµã‚ã£ã¨ã—ãŸç™ºæƒ³ãŒãŸã ã®å¹»ã«è¦‹ãˆã‚‹ã‹ã‚‚ã€‚",
            9: "è‡¨æ©Ÿå¿œå¤‰ã•ã‚ˆã‚Šã‚‚è‡ªåˆ†ãƒ«ãƒ¼ãƒ«ã‚’å„ªå…ˆã—ã€çŠ¶æ³ã‚’æŸ”ã‚‰ã‹ãè¦‹ã‚‹ã®ãŒè‹¦æ‰‹ã§ã™ã€‚ã‚ãªãŸã®ææ¡ˆã¯ãã‚Œãƒ«ãƒ¼ãƒ«ã«ãªã„ã¨è¨€ã‚ã‚Œã¦çµ‚äº†ã€‚",
            10: "å‹¢ã„ã¨æ„Ÿè¦šã§å‹•ãã‚ãªãŸã«å¯¾ã—ã€ã“ã®ã‚¿ã‚¤ãƒ—ã¯å…¨å·¥ç¨‹ã‚’è¸ã¾ãªã„ã¨å‹•ã‘ã¾ã›ã‚“ã€‚ã‚¢ã‚¤ãƒ‡ã‚¢ã¯æµ®ã‹ã‚“ã§ã‚‚å®Ÿè¡Œã¯ã»ã¼ç„¡ç†ã€‚",
            11: "æƒ…ç·’çš„ãªå¤‰åŒ–ã«å…±æ„Ÿã—ã¥ã‚‰ãã€ç‰©äº‹ã‚’ã‚¯ãƒ¼ãƒ«ã«åˆ†æã™ã‚‹å‚¾å‘ãŒã‚ã‚Šã¾ã™ã€‚ã‚ãªãŸã®æ°—æŒã¡ã¯å†·é™ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã§æ°´è’¸æ°—ã«ã•ã‚Œã¾ã™ã€‚",
            12: "å–œæ€’å“€æ¥½ã‚’ã»ã¼è¡¨ã«å‡ºã•ãªã„ã“ã®ã‚¿ã‚¤ãƒ—ã«ã€ã‚ãªãŸã¯å¸¸ã«ç§ã€å«Œã‚ã‚Œã¦ã‚‹ï¼Ÿã¨ã„ã†éŒ¯è¦šã‚’æŠ±ãã¾ã™ã€‚",
            13: "æ€è€ƒãƒ»ä½œæ¥­ãƒ»ä¼šè©±ã®ãƒšãƒ¼ã‚¹ãŒçœŸé€†ã§ã€è©±ãŒå™›ã¿åˆã†é ƒã«ã¯ã©ã¡ã‚‰ã‹ãŒå»ã£ã¦ã„ã¾ã™ã€‚",
            14: "ã‚ãªãŸã®ãªã‚“ã¨ãªããŒã€ã“ã®äººã«ã¯è«–ç†çš„æ ¹æ‹ ãŒä¸æ˜ã¨ã—ã¦ã¯ã˜ã‹ã‚Œã¾ã™ã€‚",
            15: "æ±ºæ–­ã‚’å…±æœ‰ã—ãŸã„ã‚ãªãŸã«å¯¾ã—ã€ã“ã®ã‚¿ã‚¤ãƒ—ã¯å‹æ‰‹ã«å…¨éƒ¨æ±ºã‚ãŸå¾Œã«å ±å‘Šã—ã¾ã™ã€‚",
            16: "ä¸€ã¤ã®ã“ã¨ã‚’æ·±ãæ˜ã‚ŠãŸã„ã‚ãªãŸã«ã¨ã£ã¦ã€3åˆ†ã§è©±é¡Œã‚’å¤‰ãˆã‚‹ã“ã®ã‚¿ã‚¤ãƒ—ã¯æƒ…å ±ç½å®³ã€‚",
            17: "å ´ã‚’ãªã”ã¾ã›ãŸã„ã‚ãªãŸã«ã€ã“ã®äººã¯ã§ã‚‚ãã‚ŒçŸ›ç›¾ã—ã¦ãªã„ï¼Ÿã¨æ–¬ã‚Šã‹ã‹ã£ã¦ãã¾ã™ã€‚",
            18: "æ˜”ã‚’æ‡ã‹ã—ã¿ãŸã„ã‚ãªãŸã«ã€ã“ã®äººã¯å¸¸ã«ä»ŠãŒå¤§äº‹ã—ã‹è¨€ã„ã¾ã›ã‚“ã€‚",
            19: "ç´°éƒ¨ã«ã“ã ã‚ã‚ŠãŸã„ã‚ãªãŸã«ã¨ã£ã¦ã€ã ã„ãŸã„ã§ã‚ˆããªã„ï¼ŸãŒå£ç™–ã®ã“ã®äººã¯è’é‡ãã®ã‚‚ã®ã€‚",
            20: "æ„Ÿæƒ…ã®æµã‚Œã§æ±ºã‚ã‚‹ã‚ãªãŸã«ã€ã“ã®äººã¯ãƒ‡ãƒ¼ã‚¿ã¨åˆ†æã§ç«‹ã¡ã¯ã ã‹ã‚Šã¾ã™ã€‚"
        };

        var mbtiNicknames = {
            "ISTJ": "ãã£ã¡ã‚Šé•·å®˜",
            "ISFJ": "ãŠã›ã£ã‹ã„å®ˆè­·ç¥",
            "INFJ": "é™ã‹ãªäºˆè¨€è€…",
            "INTJ": "æˆ¦ç•¥ãƒ•ãƒ«ã‚¹ãƒ­ãƒƒãƒˆãƒ«",
            "ISTP": "é»™ã£ã¦çµ„ã¿ç«‹ã¦ã‚‹äºº",
            "ISFP": "ãŸã¾ã«æ¶ˆãˆã‚‹è©©äºº",
            "INFP": "å¤¢ã‚’è¦‹ã¦ã‚‹é–“ã«å­£ç¯€ãŒå¤‰ã‚ã‚‹äºº",
            "INTP": "ãªãœãŒå£ç™–ã®ç©ºè«–æ´¾",
            "ESTP": "ã¨ã‚Šã‚ãˆãšé£›ã³è¾¼ã‚€äºº",
            "ESFP": "ãƒãƒƒãƒ”ãƒ¼çˆ†å¼¾",
            "ENFP": "äºˆå®šè¡¨ãŒç©ºã£ã½ã®å¸Œæœ›",
            "ENTP": "è©±ã™ãŸã³ã«è©±é¡ŒãŒå¤‰ã‚ã‚‹äºº",
            "ESTJ": "æ±ºã‚ãŸãŒã‚ŠéšŠé•·",
            "ESFJ": "ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã§äººã‚’æ„›ã™äºº",
            "ENFJ": "å…¨å“¡ä¸»å½¹ãŒå£ç™–ã®äºº",
            "ENTJ": "æŠ¼ã—åˆ‡ã‚ŠåŠ›ã“ãæ­£ç¾©"
        };

        var testimonies = [
            "ã“ã®ã‚¿ã‚¤ãƒ—ã¨åŒã˜è·å ´ã§3é€±é–“ã€ç›®ã‚‚åˆã‚ãªã‹ã£ãŸ",
            "ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ã§äºŒäººãã‚Šã«ãªã£ãŸæ™‚ã®æ°—ã¾ãšã•ãŒå®‡å®™è¦æ¨¡",
            "åŒã˜è¶£å‘³ã ã¨æ€ã£ãŸã‚‰ã€å…¨ç„¶é•ã†æ˜Ÿã®è©±ã ã£ãŸ",
            "ãŠã¤ã‹ã‚Œã•ã¾ã§ã™ã ã‘ã§1æ—¥ãŒçµ‚ã‚ã£ãŸ",
            "é£²ã¿ä¼šã§éš£ã®å¸­ã€ãŠäº’ã„ç„¡è¨€ã§æ–™ç†ã«é›†ä¸­",
            "ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¯ãƒ¼ã‚¯ã§è¦‹äº‹ã«ä½œæ¥­ãŒé‡è¤‡ã—ãªã„",
            "å¤©æ°—ã„ã„ã§ã™ã­ãã†ã§ã™ã­ã§ä¼šè©±ãŒçµ‚äº†",
            "ã“ã®ã‚¿ã‚¤ãƒ—ã¨åŒã˜ãƒãƒ¼ãƒ ã€Slackã ã‘ã§å®Œçµã—ãŸ",
            "å»Šä¸‹ã§ã™ã‚Œé•ã†æ™‚ã€ãŠäº’ã„æºå¸¯ã‚’è¦‹ã‚‹",
            "åŒã˜é›»è»Šã®è»Šä¸¡ã«ä¹—ã‚Šåˆã‚ã›ã‚‹ã¨ã€ãªãœã‹é…å»¶ã™ã‚‹"
        ];

        var countermeasures = [
            "é©åº¦ãªè·é›¢ã‚’ä¿ã¡ã€å¿…è¦ä»¥ä¸Šã«é–¢ã‚ã‚‰ãªã„ã®ãŒå‰ã€‚è¡¨é¢çš„ãªæŒ¨æ‹¶ã ã‘ã§ååˆ†ã§ã™ã€‚",
            "è©±é¡Œã¯å¤©æ°—ã¨ä»•äº‹ã®å ±å‘Šã®ã¿ã«çµã‚‹ã€‚æ·±ã„è©±ã¯é¿ã‘ã¾ã—ã‚‡ã†ã€‚",
            "ã‚°ãƒ«ãƒ¼ãƒ—ä½œæ¥­ã§ã¯å½¹å‰²åˆ†æ‹…ã‚’æ˜ç¢ºã«ã—ã€å€‹åˆ¥ã«ä½œæ¥­ã™ã‚‹ã®ãŒãƒ™ã‚¹ãƒˆã€‚",
            "ãƒ¡ãƒ¼ãƒ«ã‚„ãƒãƒ£ãƒƒãƒˆã§ã®é€£çµ¡ã‚’å¿ƒãŒã‘ã€ç›´æ¥çš„ãªæ¥è§¦ã‚’æœ€å°é™ã«ã€‚",
            "ã“ã®ã‚¿ã‚¤ãƒ—ã®æ„è¦‹ã«ã¯ãã†ã§ã™ã­ã¨ç›¸ã¥ã¡ã‚’æ‰“ã¡ã€è‡ªåˆ†ã®ä¸»å¼µã¯æ§ãˆã‚ã«ã€‚",
            "1å¯¾1ã®æ™‚é–“ã‚’ä½œã‚‰ãšã€å¿…ãšç¬¬ä¸‰è€…ãŒã„ã‚‹å ´ã§ä¼šè©±ã™ã‚‹ã€‚",
            "ä¾¡å€¤è¦³ã®é•ã„ã‚’å—ã‘å…¥ã‚Œã€å¤‰ãˆã‚ˆã†ã¨ã›ãšç¾çŠ¶ç¶­æŒã‚’ç›®æŒ‡ã™ã€‚",
            "å…±é€šã®è¶£å‘³ã‚„è©±é¡Œã‚’è¦‹ã¤ã‘ã‚‹ã‚ˆã‚Šã€ãŠäº’ã„ã®å°‚é–€åˆ†é‡ã‚’å°Šé‡ã™ã‚‹ã€‚",
            "æ„Ÿæƒ…çš„ã«ãªã‚‰ãšã€äº‹å®Ÿãƒ™ãƒ¼ã‚¹ã§ã®ä¼šè©±ã‚’å¿ƒãŒã‘ã‚‹ã€‚",
            "æ™‚é–“ã‚’åŒºåˆ‡ã£ã¦çŸ­æ™‚é–“ã§ã®æ¥è§¦ã«ç•™ã‚ã‚‹ã€‚é•·æ™‚é–“ã¯å±é™ºã§ã™ã€‚"
        ];

        function createStars() {
            var starsContainer = document.getElementById('stars');
            var numberOfStars = 100;
            for (var i = 0; i < numberOfStars; i++) {
                var star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }

        function validateInputs() {
            var mbti = document.getElementById('mbtiSelect').value;
            var blood = document.getElementById('bloodSelect').value;
            var zodiac = document.getElementById('zodiacSelect').value;
            var button = document.getElementById('diagnoseButton');
            button.disabled = !mbti || !blood || !zodiac;
        }

        function getRandomElement(array) {
            return array[Math.floor(seededRandom() * array.length)];
        }

        function startDiagnosis() {
            var mbti = document.getElementById('mbtiSelect').value;
            var blood = document.getElementById('bloodSelect').value;
            var zodiac = document.getElementById('zodiacSelect').value;
            if (!mbti || !blood || !zodiac) return;

            // æ–°ã—ã„seedã‚’ç”Ÿæˆã—ã¦URLã‚’æ›´æ–°
            currentSeed = Math.random().toString(36).substr(2, 8);
            seededRandom = mulberry32(hashString(currentSeed));
            var newUrl = window.location.pathname + '?mbti=' + encodeURIComponent(mbti) + '&blood=' + encodeURIComponent(blood) + '&zodiac=' + encodeURIComponent(zodiac) + '&seed=' + currentSeed;
            history.replaceState(null, '', newUrl);

            document.querySelector('.input-form').style.display = 'none';
            var loading = document.getElementById('loading');
            loading.classList.add('active');

            setTimeout(function () {
                showResult(mbti, blood, zodiac);
            }, seededRandom() * 1000 + 2000);
        }

        function showResult(userMbti, userBlood, userZodiac) {
            var loading = document.getElementById('loading');
            var resultArea = document.getElementById('resultArea');
            var mapping = mbtiMapping[userMbti];
            var worstMbti = mapping.worstMatch;
            var conflictType = mapping.conflictType;

            var bloodTypes = ['A', 'B', 'O', 'AB'];
            var zodiacs = ['ç‰¡ç¾Šåº§', 'ç‰¡ç‰›åº§', 'åŒå­åº§', 'èŸ¹åº§', 'ç…å­åº§', 'ä¹™å¥³åº§', 'å¤©ç§¤åº§', 'è åº§', 'å°„æ‰‹åº§', 'å±±ç¾Šåº§', 'æ°´ç“¶åº§', 'é­šåº§'];
            var worstBlood = getRandomElement(bloodTypes);
            var worstZodiac = getRandomElement(zodiacs);

            var userNickname = mbtiNicknames[userMbti];
            var worstNickname = mbtiNicknames[worstMbti];
            var codeName = userNickname + ' vs ' + worstNickname;
            var codeAlias = 'çµ¶å¯¾ã«çµ„ã¾ã›ã¦ã¯ã„ã‘ãªã„ ' + userMbti + 'Ã—' + worstMbti + ' ãƒšã‚¢';
            var conflictDescription = conflictTemplates[conflictType];
            var countermeasure = getRandomElement(countermeasures);
            var testimony = getRandomElement(testimonies);

            currentResult = {
                user: { mbti: userMbti, blood: userBlood, zodiac: userZodiac },
                worst: { mbti: worstMbti, blood: worstBlood, zodiac: worstZodiac },
                codeName: codeName,
                codeAlias: codeAlias
            };

            document.getElementById('userType').innerHTML = userMbti + ' Ã— ' + userBlood + 'å‹ Ã— ' + userZodiac + '<br><small style="color: #888; margin-top: 10px; display: block;">' + mbtiPersonality[userMbti] + '</small>';
            document.getElementById('worstType').innerHTML = worstMbti + ' Ã— ' + worstBlood + 'å‹ Ã— ' + worstZodiac + '<br><small style="color: #888; margin-top: 10px; display: block;">' + mbtiPersonality[worstMbti] + '</small>';
            document.getElementById('codeName').textContent = codeName;
            document.getElementById('codeAlias').textContent = codeAlias;
            document.getElementById('codeDescription').textContent = conflictDescription;
            document.getElementById('countermeasureText').textContent = countermeasure;
            document.getElementById('testimonyText').textContent = testimony;

            loading.classList.remove('active');
            resultArea.classList.add('active');
        }

        function shareToTwitter() {
            if (!currentResult) return;
            var shareText = 'ZURE MATCHè¨ºæ–­çµæœï¼šç§ã®ç›¸æ€§æœ€æ‚ªã‚¿ã‚¤ãƒ—ã¯' + currentResult.codeAlias + 'ã§ã—ãŸï¼ã“ã®è¨ºæ–­ã€å¦™ã«å½“ãŸã£ã¦ã‚‹æ°—ãŒã™ã‚‹... #ZUREMATCH #ç›¸æ€§è¨ºæ–­';
            var shareUrl = window.location.href;
            var twitterUrl = 'https://twitter.com/intent/tweet?text=' + encodeURIComponent(shareText) + '&url=' + encodeURIComponent(shareUrl);
            window.open(twitterUrl, '_blank', 'width=600,height=400');
        }

        function shareToLine() {
            if (!currentResult) return;
            var shareText = 'ZURE MATCHã§ç›¸æ€§è¨ºæ–­ã—ã¦ã¿ã¾ã—ãŸï¼ç§ã®ç›¸æ€§æœ€æ‚ªã‚¿ã‚¤ãƒ—ã¯' + currentResult.codeAlias + 'ã§ã—ãŸğŸ˜…ã‚ãªãŸã‚‚è©¦ã—ã¦ã¿ã¦ï¼';
            var shareUrl = window.location.href;
            if (/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                var lineUrl = 'https://line.me/R/msg/text/?' + encodeURIComponent(shareText + ' ' + shareUrl);
                window.location.href = lineUrl;
            } else {
                var lineUrl = 'https://social-plugins.line.me/lineit/share?url=' + encodeURIComponent(shareUrl) + '&text=' + encodeURIComponent(shareText);
                window.open(lineUrl, '_blank', 'width=600,height=400');
            }
        }

        function restartDiagnosis() {
            var resultArea = document.getElementById('resultArea');
            var inputForm = document.querySelector('.input-form');
            resultArea.classList.remove('active');
            inputForm.style.display = 'block';
            document.getElementById('mbtiSelect').value = '';
            document.getElementById('bloodSelect').value = '';
            document.getElementById('zodiacSelect').value = '';
            validateInputs();
            currentResult = null;
            window.scrollTo(0, 0);
        }

        document.addEventListener('DOMContentLoaded', function () {
            createStars();
            document.getElementById('mbtiSelect').addEventListener('change', validateInputs);
            document.getElementById('bloodSelect').addEventListener('change', validateInputs);
            document.getElementById('zodiacSelect').addEventListener('change', validateInputs);
            validateInputs();

            // URLã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒã‚ã‚Œã°è‡ªå‹•ã§çµæœã‚’è¡¨ç¤º
            var mbti = urlParams.get('mbti');
            var blood = urlParams.get('blood');
            var zodiac = urlParams.get('zodiac');
            var seed = urlParams.get('seed');
            if (mbti && blood && zodiac && seed) {
                currentSeed = seed;
                seededRandom = mulberry32(hashString(currentSeed));
                document.querySelector('.input-form').style.display = 'none';
                showResult(mbti, blood, zodiac);
            }
        });
    </script>
</body>

</html>